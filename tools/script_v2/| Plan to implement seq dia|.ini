│ Plan: สร้าง 7 Sequence Diagrams ตามกิจกรรม                                                                       │
│                                                                                                                │
│ Context                                                                                                        │
│                                                                                                                │
│ โปรเจคมี activity diagrams (activity_diagram_1-4) อยู่แล้ว และมี sequence diagrams แบบ per-file                     │
│ (seq_extract_ui_manifest.puml, etc.) อยู่แล้ว แต่ยังไม่มี sequence diagrams ที่จัดตามกิจกรรม ทั้ง 7 กิจกรรม ซึ่งจะช่วยแสดง      │
│ interaction ระหว่าง objects/participants ในแต่ละขั้นตอน                                                            │
│                                                                                                                │
│ Files to Create (7 files in docs/)                                                                             │
│ #: 1                                                                                                           │
│ ไฟล์: seq_act1_import_widget_metadata.puml                                                                      │
│ กิจกรรม: การนำเข้าและสกัดข้อมูลเมตาของวิดเจ็ต                                                                         │
│ Source files ที่เกี่ยวข้อง: server.dart → extract_ui_manifest.dart                                                  │
│ ────────────────────────────────────────                                                                       │
│ #: 2                                                                                                           │
│ ไฟล์: seq_act2_extract_widget_frontend.puml                                                                     │
│ กิจกรรม: การสกัดวิดเจ็ตและข้อมูลเมตาจากไฟล์ฟรอนต์เอนด์                                                                  │
│ Source files ที่เกี่ยวข้อง: extract_ui_manifest.dart (internal)                                                     │
│ ────────────────────────────────────────                                                                       │
│ #: 3                                                                                                           │
│ ไฟล์: seq_act3_generate_datasets_llm.puml                                                                       │
│ กิจกรรม: การสร้างชุดข้อมูลจำลองด้วยโมเดลภาษาขนาดใหญ่                                                                  │
│ Source files ที่เกี่ยวข้อง: generate_datasets.dart → Gemini API                                                     │
│ ────────────────────────────────────────                                                                       │
│ #: 4                                                                                                           │
│ ไฟล์: seq_act4_input_test_cases.puml                                                                            │
│ กิจกรรม: การป้อนอินพุตเพื่อสร้างกรณีทดสอบ                                                                              │
│ Source files ที่เกี่ยวข้อง: generate_test_data.dart → generator_pict.dart                                           │
│ ────────────────────────────────────────                                                                       │
│ #: 5                                                                                                           │
│ ไฟล์: seq_act5_pairwise_test_cases.puml                                                                         │
│ กิจกรรม: การสร้างกรณีทดสอบในรูปแบบแพร์ไวส์                                                                           │
│ Source files ที่เกี่ยวข้อง: generator_pict.dart → PICT binary                                                       │
│ ────────────────────────────────────────                                                                       │
│ #: 6                                                                                                           │
│ ไฟล์: seq_act6_generate_test_data.puml                                                                          │
│ กิจกรรม: การสร้างข้อมูลทดสอบ                                                                                       │
│ Source files ที่เกี่ยวข้อง: generate_test_data.dart (build cases)                                                   │
│ ────────────────────────────────────────                                                                       │
│ #: 7                                                                                                           │
│ ไฟล์: seq_act7_generate_test_script.puml                                                                        │
│ กิจกรรม: การสร้างสคริปต์ทดสอบอัตโนมัติ                                                                                │
│ Source files ที่เกี่ยวข้อง: generate_test_script.dart                                                               │
│ Diagram Style (สอดคล้องกับ existing diagrams)                                                                    │
│                                                                                                                │
│ - Title ภาษาไทย + subtitle ภาษาอังกฤษ                                                                           │
│ - skinparam consistent กับ existing sequence diagrams                                                           │
│ - Participant labels เป็นภาษาอังกฤษ (class/method names)                                                         │
│ - Notes อธิบายเป็นภาษาอังกฤษ (technical details)                                                                  │
│ - ใช้ group, alt, loop, note blocks                                                                             │
│                                                                                                                │
│ รายละเอียดแต่ละ Diagram                                                                                          │
│                                                                                                                │
│ 1. การนำเข้าและสกัดข้อมูลเมตาของวิดเจ็ต                                                                              │
│                                                                                                                │
│ Focus: จุดเริ่มต้น - User/WebUI ส่งไฟล์ path ไปยัง Server แล้ว Server เรียก extractor                                   │
│ - Participants: User, WebUI (main.js), Server (server.dart), UiManifestExtractor, FileSystem                   │
│ - Flow: User click → POST /scan → extractManifest() → validate → read file → return manifestPath               │
│ - ไม่ลงลึก internal extraction (เป็นของ diagram #2)                                                               │
│                                                                                                                │
│ 2. การสกัดวิดเจ็ตและข้อมูลเมตาจากไฟล์ฟรอนต์เอนด์                                                                       │
│                                                                                                                │
│ Focus: Internal process ของ _processOne() - strip comments, scan widgets, extract metadata                     │
│ - Participants: _processOne, _stripComments, _scanWidgets, _extractKey, _extractTextFieldMeta,                 │
│ _extractValidationMeta, _scanDateTimePickers, FileSystem                                                       │
│ - Flow: Read source → strip comments → collect consts → find page metadata → scan 20 widget types → scan       │
│ pickers → filter/dedup → sort → write manifest JSON                                                            │
│ - แสดง loop scan widgets พร้อม alt per widget type                                                              │
│                                                                                                                │
│ 3. การสร้างชุดข้อมูลจำลองด้วยโมเดลภาษาขนาดใหญ่                                                                       │
│                                                                                                                │
│ Focus: Gemini AI interaction - สร้าง prompt, เรียก API, parse response                                           │
│ - Participants: DatasetGenerator, _processManifest, _callGeminiForDatasets, Gemini API, FileSystem             │
│ - Flow: Read manifest → filter text fields → resolve API key → build prompt → POST to Gemini → parse response  │
│ → apply maxLength → write datasets JSON                                                                        │
│ - แสดง alt: no text fields (skip) vs has text fields                                                           │
│                                                                                                                │
│ 4. การป้อนอินพุตเพื่อสร้างกรณีทดสอบ                                                                                   │
│                                                                                                                │
│ Focus: การเตรียม input สำหรับ PICT - extract factors จาก manifest widgets                                        │
│ - Participants: TestDataGenerator, GeneratorPict, FileSystem                                                   │
│ - Flow: Read manifest → extractFactorsFromManifest() → classify widgets by type → create factor-value pairs →  │
│ apply constraints → write model files                                                                          │
│ - แสดง note อธิบาย factor types (text→valid/invalid, radio→options, etc.)                                       │
│                                                                                                                │
│ 5. การสร้างกรณีทดสอบในรูปแบบแพร์ไวส์                                                                                │
│                                                                                                                │
│ Focus: PICT execution - เขียน model, รัน binary, parse ผลลัพธ์                                                     │
│ - Participants: GeneratorPict, PICT Binary, FileSystem                                                         │
│ - Flow: generatePictModel() → write model.txt → execute ./pict → parse result → generateValidOnlyPictModel() → │
│  execute → parse                                                                                               │
│ - แสดง model format ใน note + result format                                                                    │
│ - alt: PICT binary available vs fallback to internal algorithm                                                 │
│                                                                                                                │
│ 6. การสร้างข้อมูลทดสอบ                                                                                            │
│                                                                                                                │
│ Focus: สร้าง test cases จาก PICT combinations + datasets                                                        │
│ - Participants: TestDataGenerator (_processOne), GeneratorPict, FileSystem                                     │
│ - Flow: Load PICT results → load datasets → for each combination: map to steps (enterText/tap/selectDate/etc)  │
│ → create asserts → build valid_invalid cases → build valid cases → build edge cases → write testdata.json      │
│ - แสดง loop per combination + alt per factor type                                                              │
│                                                                                                                │
│ 7. การสร้างสคริปต์ทดสอบอัตโนมัติ                                                                                     │
│                                                                                                                │
│ Focus: Code generation - สร้าง Flutter test script จาก testdata                                                 │
│ - Participants: TestScriptGenerator, _processOne, _generateIntegrationTests, FileSystem                        │
│ - Flow: Read testdata → resolve package/providers → generate stubs → generate _wrap() → group cases → for each │
│  case: generate steps + asserts → write integration test                                                       │
│ - แสดง note ตัวอย่าง generated code                                                                              │
│                                                                                                                │
│ Implementation Steps                                                                                           │
│                                                                                                                │
│ 1. สร้างไฟล์ทีละไฟล์ตามลำดับ 1-7                                                                                    │
│ 2. ใช้ consistent skinparam across all 7 files                                                                  │
│ 3. ลบ 4 ไฟล์ per-file เก่า (seq_extract_ui_manifest.puml, seq_generate_datasets.puml,                            │
│ seq_generate_test_data.puml, seq_generate_test_script.puml) เนื่องจากถูกแทนที่ด้วย 7 activity-based diagrams         │
│                                                                                                                │
│ Verification                                                                                                   │
│                                                                                                                │
│ - ตรวจสอบว่า PlantUML syntax ถูกต้อง (มี @startuml/@enduml)                                                        │
│ - ตรวจสอบว่า participants, messages ตรงกับ source code จริง                                                       │
│ - ตรวจสอบว่า title ภาษาไทยตรงกับ activity ที่ user ระบุ   