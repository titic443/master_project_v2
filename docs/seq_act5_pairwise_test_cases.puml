@startuml seq_act5_pairwise_test_cases

title แผนภาพลำดับกิจกรรมที่ 5: การสร้างกรณีทดสอบในรูปแบบแพร์ไวส์

participant ":TestDataGenerator" as gen
participant ":GeneratorPict" as pict
participant ":PICT Binary" as bin
participant ":FileSystem" as fs

gen -> pict : 1 : writePictModelFiles(factors, pageBaseName)
pict -> fs : 2 : readModelFile(fullModelPath)
fs --> pict : 3 : fullModelContent
pict -> bin : 4 : execute ./pict fullModelPath
bin --> pict : 5 : tab-separated combinations
pict -> fs : 6 : writeResultFile(fullResultPath)

pict -> fs : 7 : readModelFile(validModelPath)
fs --> pict : 8 : validModelContent
pict -> bin : 9 : execute ./pict validModelPath
bin --> pict : 10 : tab-separated combinations
pict -> fs : 11 : writeResultFile(validResultPath)
pict --> gen : 12 : done

gen -> fs : 13 : readResultFile(fullResultPath)
fs --> gen : 14 : fullResultContent
gen -> pict : 15 : parsePictResult(fullResultContent)
pict --> gen : 16 : extCombos [List<Map>]

gen -> fs : 17 : readResultFile(validResultPath)
fs --> gen : 18 : validResultContent
gen -> pict : 19 : parsePictResult(validResultContent)
pict --> gen : 20 : extValidCombos [List<Map>]

alt [PICT binary not available]
    gen -> pict : 21 : generatePairwiseInternal(factors)

    loop [Until all pairs covered]
        pict -> pict : 22 : findBestCase() — greedy set cover
    end

    pict --> gen : 23 : combinations (fallback)
end

@enduml
