# üìä Activity Diagrams - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

> **Flutter Automated Integration Test Generator**
> Activity Diagrams ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô 4 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å

---

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
2. [Diagram 1: ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏±‡∏î‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ](#diagram-1-‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏±‡∏î‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)
3. [Diagram 2: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡πÑ‡∏≠](#diagram-2-‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡πÑ‡∏≠)
4. [Diagram 3: ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö Pairwise](#diagram-3-‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö-pairwise)
5. [Diagram 4: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö](#diagram-4-‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
6. [‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô PlantUML Diagrams](#‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô-plantuml-diagrams)
7. [‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°](#‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)

---

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö

‡∏£‡∏∞‡∏ö‡∏ö Flutter Automated Integration Test Generator ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ **4 Process ‡∏´‡∏•‡∏±‡∏Å** ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏±‡∏ô:

```mermaid
graph LR
    A[lib/*.dart] -->|1| B[Manifest JSON]
    B -->|2| C[Datasets JSON]
    C -->|3| D[TestData JSON]
    D -->|4| E[Integration Test]

    style A fill:#E3F2FD
    style B fill:#E8F5E9
    style C fill:#FCE4EC
    style D fill:#F3E5F5
    style E fill:#FFF9C4
```

### üîÑ ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

| ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô | ‡πÑ‡∏ü‡∏•‡πå Tool | Input | Output | ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì |
|---------|----------|-------|--------|------------|
| 1Ô∏è‚É£ | `extract_ui_manifest.dart` | `lib/**/*_page.dart` | `output/manifest/**/*.manifest.json` | ~1-2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ/‡πÑ‡∏ü‡∏•‡πå |
| 2Ô∏è‚É£ | `generate_datasets.dart` | `output/manifest/**/*.manifest.json` | `output/test_data/*.datasets.json` | ~3-5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ/‡πÑ‡∏ü‡∏•‡πå (AI) |
| 3Ô∏è‚É£ | `generate_test_data.dart` | `output/manifest/**/*.manifest.json`<br>`output/test_data/*.datasets.json` | `output/test_data/*.testdata.json`<br>`output/model_pairwise/*.txt` | ~2-4 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ/‡πÑ‡∏ü‡∏•‡πå |
| 4Ô∏è‚É£ | `generate_test_script.dart` | `output/test_data/*.testdata.json` | `integration_test/*_flow_test.dart` | ~1-2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ/‡πÑ‡∏ü‡∏•‡πå |

---

## üîç Diagram 1: ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏±‡∏î‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

### üìÅ ‡πÑ‡∏ü‡∏•‡πå: `activity_diagram_1_ui_manifest.puml`

### üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏ü‡∏•‡πå Flutter Dart ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• UI widgets ‡πÅ‡∏•‡∏∞ metadata ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON

### üì• Input
- **‡πÑ‡∏ü‡∏•‡πå Flutter Page**: `lib/demos/*_page.dart`, `lib/**/*_page.dart`
- **‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö**: Flutter Widget code (StatefulWidget/StatelessWidget)

### üì§ Output
- **‡πÑ‡∏ü‡∏•‡πå Manifest**: `output/manifest/**/*.manifest.json`
- **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á**:
  ```json
  {
    "source": {
      "file": "lib/demos/register_page.dart",
      "pageClass": "RegisterPage",
      "cubitClass": "RegisterCubit",
      "stateClass": "RegisterState",
      "fileCubit": "lib/cubit/register_cubit.dart",
      "fileState": "lib/cubit/register_state.dart"
    },
    "widgets": [
      {
        "widgetType": "TextFormField",
        "key": "1_customer_firstname_textfield",
        "meta": {
          "keyboardType": "text",
          "maxLength": 50,
          "validatorRules": [
            {
              "condition": "value == null || value.isEmpty",
              "message": "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠"
            },
            {
              "condition": "!RegExp(r'^[a-zA-Z]{2,}$').hasMatch(value)",
              "message": "‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£"
            }
          ]
        }
      }
    ]
  }
  ```

### üîß ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

#### 1. **Pre-processing**
- **‡∏•‡∏ö Comments**: ‡∏•‡∏ö `//` ‡πÅ‡∏•‡∏∞ `/* */` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
- **‡∏™‡∏Å‡∏±‡∏î Constants**: ‡∏î‡∏∂‡∏á `const VAR = 'value'` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤ placeholder

#### 2. **Widget Scanning**
‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏≤ Widget types ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:
- `TextField`, `TextFormField`
- `ElevatedButton`, `TextButton`, `OutlinedButton`, `IconButton`
- `DropdownButton`, `DropdownButtonFormField`
- `Radio`, `Checkbox`, `Switch`, `SwitchListTile`
- `DatePicker` (via `showDatePicker`), `TimePicker` (via `showTimePicker`)

#### 3. **Metadata Extraction**
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ Widget:
- **Key Extraction**: `Key('...')`, `ValueKey<T>('...')`, `ObjectKey([...])`
- **Validation Rules**: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå `validator:` closure
  - ‡πÅ‡∏¢‡∏Å condition (`if (...)`)
  - ‡πÅ‡∏¢‡∏Å message (`return 'message';`)
  - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ternary `(condition) ? 'msg' : null`
- **Input Formatters**:
  - `FilteringTextInputFormatter.digitsOnly`
  - `FilteringTextInputFormatter.allow(RegExp(...))`
  - `LengthLimitingTextInputFormatter(n)`
- **Picker Metadata**:
  - DatePicker: `firstDate`, `lastDate`, `initialDate`
  - TimePicker: `initialTime`

#### 4. **State Management Detection**
- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ `BlocBuilder<CubitClass, StateClass>`
- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ `context.read<CubitClass>()`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö import statements ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ Cubit/State file paths

#### 5. **Sorting ‡πÅ‡∏•‡∏∞ Filtering**
- **‡∏Å‡∏£‡∏≠‡∏á**: ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ widgets ‡∏ó‡∏µ‡πà‡∏°‡∏µ `key`
- **Deduplicate**: ‡∏•‡∏ö duplicate keys (‡πÄ‡∏Å‡πá‡∏ö first occurrence)
- **‡πÄ‡∏£‡∏µ‡∏¢‡∏á**:
  1. Priority 1: Widgets ‡∏ó‡∏µ‡πà‡∏°‡∏µ `SEQUENCE` pattern (`1_`, `2_`, `3_`...)
  2. Priority 2: Widgets ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ï‡∏≤‡∏° source order

#### 6. **Output Generation**
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì output path ‡∏ï‡∏≤‡∏° subfolder structure
- ‡∏™‡∏£‡πâ‡∏≤‡∏á directory ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ (`recursive: true`)
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô JSON ‡∏û‡∏£‡πâ‡∏≠‡∏° indent 2 spaces
- **‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **Manifest File** ‡πÇ‡∏î‡∏¢‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `output/manifest/` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
- **‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á Widgets**: ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡∏î‡πÄ‡∏à‡πá‡∏ï‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏µ‡∏¢‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ß‡∏¥‡∏î‡πÄ‡∏à‡πá‡∏ï‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏¢ ‡∏ß‡∏¥‡∏î‡πÄ‡∏à‡πá‡∏ï‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Manifest

### üí° ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
- ‚úÖ **Automatic Cubit/State Detection** - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏ manually
- ‚úÖ **SEQUENCE-based Sorting** - ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ
- ‚úÖ **Picker Metadata** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö DatePicker/TimePicker constraints
- ‚úÖ **Robust Regex Parsing** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö raw strings, escapes

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î
- ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö dynamic widget creation (e.g., `ListView.builder`)
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ explicit `Key(...)` (‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö auto-generated keys)
- Validation rules ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô inline lambda (‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö extracted functions)

---

## ü§ñ Diagram 2: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡πÑ‡∏≠

### üìÅ ‡πÑ‡∏ü‡∏•‡πå: `activity_diagram_2_ai_datasets.puml`

### üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
‡πÉ‡∏ä‡πâ AI (Google Gemini) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö (valid/invalid pairs) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö TextField/TextFormField

### üì• Input
- **Manifest Files**: `output/manifest/**/*.manifest.json`
- **API Key**: Gemini API key (‡∏à‡∏≤‡∏Å `.env`, ENV, ‡∏´‡∏£‡∏∑‡∏≠ hardcoded)

### üì§ Output
- **Dataset Files**: `output/test_data/*.datasets.json`
- **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á**:
  ```json
  {
    "file": "lib/demos/register_page.dart",
    "datasets": {
      "byKey": {
        "1_customer_firstname_textfield": [
          {
            "valid": "Alice",
            "invalid": "A",
            "invalidRuleMessages": "‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£"
          },
          {
            "valid": "Bob",
            "invalid": "B",
            "invalidRuleMessages": "‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£"
          }
        ],
        "2_customer_email_textfield": [...]
      }
    }
  }
  ```

### üîß ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

#### 1. **API Key Resolution**
‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Priority):
1. `--api-key` command-line flag
2. `.env` file (`GEMINI_API_KEY=...`)
3. Environment variable
4. Hardcoded constant (for development only)

#### 2. **Field Classification**
‡πÅ‡∏¢‡∏Å TextFormField ‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Å‡∏•‡∏∏‡πà‡∏°:
- **fieldsWithoutRules**: ‡πÑ‡∏°‡πà‡∏°‡∏µ `validatorRules` ‚Üí Local generation (1 valid, 0 invalid)
- **fieldsWithRules**: ‡∏°‡∏µ `validatorRules` ‚Üí AI generation (N pairs)

#### 3. **Local Generation (No Rules)**
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö fields ‡πÑ‡∏°‡πà‡∏°‡∏µ validation rules:
```dart
// ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå constraints
final constraints = _analyzeConstraintsFromMeta(key, meta);
  - keyboardType (email, number, phone)
  - inputFormatters (digitsOnly, allow/deny patterns)
  - maxLength

// ‡∏™‡∏£‡πâ‡∏≤‡∏á 1 valid value
final validValue = _generateValidData(key, constraints);
  - Email: "test@example.com"
  - Digits: "123"
  - Text: random alphanumeric

// No invalid values (‡πÑ‡∏°‡πà‡∏°‡∏µ rules ‡πÉ‡∏´‡πâ‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô)
```

#### 4. **AI Generation (With Rules)**

##### üìù Prompt Structure
```text
=== (CONTEXT) ===
Test data generator for Flutter form validation.

=== (TARGET) ===
QA engineers need realistic test data for happy path and errors.

=== (OBJECTIVE) ===
1. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå constraints (maxLength, inputFormatters, validatorRules)
2. ‡∏Å‡∏£‡∏≠‡∏á isEmpty/null rules (tested separately)
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á valid/invalid pairs ONLY for non-empty rules
4. CRITICAL: Invalid values MUST pass inputFormatters but FAIL validators
5. Output valid JSON

=== (EXECUTION) ===
1. ‡∏ô‡∏±‡∏ö non-empty rules (SKIP "isEmpty"/"== null") ‚Üí N
2. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ non-empty rule: ‡∏™‡∏£‡πâ‡∏≤‡∏á 1 valid + 1 invalid pair
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á N pairs (total N valid + N invalid)

Example:
Input: {"field":"firstname","validatorRules":[
  {"condition":"value == null || value.isEmpty","message":"Required"},
  {"condition":"!RegExp(r'^[a-zA-Z]{2,}$').hasMatch(value)","message":"Min 2"}]}
Non-empty rules: 1 (SKIP isEmpty) ‚Üí N=1 pair
Output: {"firstname":[
  {"valid":"Alice","invalid":"A","invalidRuleMessages":"Min 2"}
]}
```

##### üåê API Call Flow
```dart
// 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á HTTP Client
final client = HttpClient();

// 2. POST request ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Gemini
final req = await client.postUrl(endpoint);
req.headers.set(HttpHeaders.contentTypeHeader, 'application/json');
req.add(utf8.encode(jsonEncode(payload)));

// 3. ‡∏£‡∏±‡∏ö response
final resp = await req.close();
final body = await resp.transform(utf8.decoder).join();

// 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö status code
if (resp.statusCode < 200 || resp.statusCode >= 300) {
  throw HttpException('Gemini HTTP ${resp.statusCode}');
}

// 5. Parse JSON
final decoded = jsonDecode(body);
final text = _extractTextFromGemini(decoded);

// 6. ‡∏•‡∏ö markdown fences (```json ... ```)
final cleaned = _stripCodeFences(text);

// 7. Parse ‡πÄ‡∏õ‡πá‡∏ô datasets
final parsed = jsonDecode(cleaned);
```

#### 5. **Post-processing**
- **Normalize maxLength**: ‡∏ï‡∏±‡∏î valid values ‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô `maxLength`
- **Keep invalid as-is**: invalid values ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Å‡∏¥‡∏ô `maxLength` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö

#### 6. **Merge ‡πÅ‡∏•‡∏∞ Output**
```dart
final result = {
  'file': uiFile,
  'datasets': {
    'byKey': {
      // fields without rules (local)
      'field1': [{'valid': '...', 'invalid': ''}],
      // fields with rules (AI)
      'field2': [{'valid': '...', 'invalid': '...', 'invalidRuleMessages': '...'}]
    }
  }
};
```

### üí° ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
- ‚úÖ **AI-Powered**: ‡∏™‡∏£‡πâ‡∏≤‡∏á realistic test data ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‚úÖ **Rule-Aware**: Invalid values ‡∏ú‡πà‡∏≤‡∏ô input formatters ‡πÅ‡∏ï‡πà fail validators
- ‚úÖ **Multilingual**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Thai/English validation messages
- ‚úÖ **Local Fallback**: ‡∏°‡∏µ `--local-only` mode ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö offline

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ API key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mode ‡∏õ‡∏Å‡∏ï‡∏¥
- AI response ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà perfect 100% (‡∏ï‡πâ‡∏≠‡∏á verify)
- Rate limits ‡∏à‡∏≤‡∏Å Gemini API (free tier: 15 requests/minute)

---

## üîÄ Diagram 3: ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö Pairwise

### üìÅ ‡πÑ‡∏ü‡∏•‡πå: `activity_diagram_3_pairwise_plan.puml`

### üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö Pairwise Testing ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô test cases ‡πÅ‡∏ï‡πà‡∏Ñ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°

### üì• Input
- **Manifest Files**: `output/manifest/**/*.manifest.json`
- **Dataset Files**: `output/test_data/*.datasets.json`
- **PICT Binary**: `./pict` (Pairwise Independent Combinatorial Testing tool)

### üì§ Output
- **Test Plan Files**: `output/test_data/*.testdata.json`
- **PICT Model Files**: `output/model_pairwise/*.txt`
- **PICT Result Files**: `output/model_pairwise/*.result.txt`

### üîß ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

#### 1. **Widget Classification**
‡πÅ‡∏¢‡∏Å widgets ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°:
```dart
final textKeys = [];        // TextFormField keys
final radioKeys = [];       // Radio widget keys
final dropdownKeys = [];    // Dropdown keys
final checkboxKeys = [];    // Checkbox keys
final datePickerKeys = [];  // DatePicker keys
final timePickerKeys = [];  // TimePicker keys
final endKey = ...;         // Submit button (highest SEQUENCE)
```

#### 2. **Factor Creation**
‡∏™‡∏£‡πâ‡∏≤‡∏á PICT factors:

| Widget Type | Factor Name | Values |
|-------------|-------------|--------|
| TextField #1 | `TEXT` | `{valid, invalid}` |
| TextField #2 | `TEXT2` | `{valid, invalid}` |
| TextField #3 | `TEXT3` | `{valid, invalid}` |
| Radio Group #1 | `Radio1` | `{option1_radio, option2_radio, ...}` |
| Dropdown | `Dropdown` | `{value1, value2, value3}` |
| Checkbox #1 | `Checkbox` | `{checked, unchecked}` |
| DatePicker | `customer_07_birthdate_field` | `{15/01/2000, null, ...}` |
| TimePicker | `customer_08_time_field` | `{09:00, 14:30, null}` |

#### 3. **PICT Model Generation**
‡∏™‡∏£‡πâ‡∏≤‡∏á 2 model files:

**3.1. Full Model** (`<page>.full.model.txt`):
```
TEXT: valid, invalid
TEXT2: valid, invalid
Radio1: option1_radio, option2_radio, option3_radio
Dropdown: value1, value2, value3
Checkbox: checked, unchecked
customer_07_birthdate_field: 15/01/2000, 25/06/1995, null

# Constraints
IF [TEXT] = "invalid" THEN [TEXT2] <> "invalid";
```

**3.2. Valid-Only Model** (`<page>.valid.model.txt`):
```
TEXT: valid
TEXT2: valid
Radio1: option1_radio, option2_radio, option3_radio
Dropdown: value1, value2, value3
Checkbox: checked, unchecked
customer_07_birthdate_field: 15/01/2000, 25/06/1995, null
```

#### 4. **PICT Execution**
```bash
./pict <page>.full.model.txt > <page>.full.result.txt
./pict <page>.valid.model.txt > <page>.valid.result.txt
```

**PICT Result Example**:
```
TEXT	TEXT2	Radio1	Dropdown	Checkbox
valid	valid	option1_radio	value1	checked
valid	invalid	option2_radio	value2	unchecked
invalid	valid	option3_radio	value3	checked
invalid	invalid	option1_radio	value1	unchecked
...
```

#### 5. **Test Case Generation**

##### 5.1. Parse PICT Result
```dart
final combos = pict.parsePictResult(File(pageResultPath).readAsStringSync());
// combos = [
//   {'TEXT': 'valid', 'TEXT2': 'valid', 'Radio1': 'option1_radio', ...},
//   {'TEXT': 'valid', 'TEXT2': 'invalid', 'Radio1': 'option2_radio', ...},
//   ...
// ]
```

##### 5.2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Test Steps
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ combination:
```dart
// Build steps dictionary (preserve widget order)
final stepsByKey = <String, List<Map<String, dynamic>>>{};

// 1. TextField factors
for (TEXT factor) {
  final bucket = combo['TEXT']; // 'valid' or 'invalid'
  stepsByKey[textKey] = [
    {'enterText': {'byKey': textKey, 'dataset': 'byKey.$textKey[0].$bucket'}},
    {'pump': true}
  ];
}

// 2. Radio factors
for (Radio factor) {
  final pick = combo['Radio1']; // 'option1_radio'
  final matchedKey = _radioKeyForSuffix(radioKeys, pick);
  stepsByKey[matchedKey] = [
    {'tap': {'byKey': matchedKey}},
    {'pump': true}
  ];
}

// 3. Dropdown factors
final ddPick = combo['Dropdown']; // 'value1'
stepsByKey[dropdownKey] = [
  {'tap': {'byKey': dropdownKey}},
  {'pump': true},
  {'tapText': valueToTextMapping[ddPick]}, // Use display text
  {'pump': true}
];

// 4. Checkbox factors
if (combo['Checkbox'] == 'checked') {
  stepsByKey[checkboxKey] = [
    {'tap': {'byKey': checkboxKey}},
    {'pump': true}
  ];
}

// 5. DatePicker factors
final datePick = combo['customer_07_birthdate_field']; // '15/01/2000'
stepsByKey[datePickerKey] = [
  {'tap': {'byKey': datePickerKey}},
  {'pumpAndSettle': true},
  {'selectDate': datePick},  // 'DD/MM/YYYY' or 'null'
  {'pumpAndSettle': true}
];

// 6. End Button
if (endKey != null) {
  steps.add({'tap': {'byKey': endKey}});
  steps.add({'pumpAndSettle': true});
}
```

##### 5.3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Assertions
```dart
bool hasInvalidData = steps.any((s) => s.contains('invalid'));

if (hasInvalidData) {
  // Failed case: expect validation error messages
  for (invalidField in invalidFields) {
    final invalidMsg = datasets['byKey'][invalidField][0]['invalidRuleMessages'];
    // Only include non-empty/non-required messages
    if (invalidMsg != null && !invalidMsg.contains('Required')) {
      asserts.add({'text': invalidMsg, 'exists': true});
    }
  }
  // Expect fail keys
  for (failKey in expectedFailKeys) {
    asserts.add({'byKey': failKey, 'exists': true});
  }
} else {
  // Success case: expect success keys
  for (successKey in expectedSuccessKeys) {
    asserts.add({'byKey': successKey, 'exists': true});
  }
}
```

#### 6. **Edge Cases**
‡∏™‡∏£‡πâ‡∏≤‡∏á empty-all-fields test case:
```dart
// Analyze required fields
final expectedMsgsCount = <String, int>{};
for (widget in widgets) {
  for (rule in widget.meta.validatorRules) {
    if (_isEmptyCheckCondition(rule.condition)) {
      expectedMsgsCount[rule.message]++;
    }
  }
}

// Create empty test case
cases.add({
  'tc': 'edge_cases_empty_all_fields',
  'kind': 'failed',
  'group': 'edge_cases',
  'steps': [
    {'tap': {'byKey': endKey}},
    {'pumpAndSettle': true}
  ],
  'asserts': [
    for (entry in expectedMsgsCount.entries)
      {'text': entry.key, 'exists': true, 'count': entry.value}
  ]
});
```

#### 7. **Output Structure**
```json
{
  "source": {...},
  "datasets": {...},
  "cases": [
    {
      "tc": "pairwise_valid_invalid_cases_1",
      "kind": "success",
      "group": "pairwise_valid_invalid_cases",
      "steps": [...],
      "asserts": [...]
    },
    {
      "tc": "pairwise_valid_invalid_cases_2",
      "kind": "failed",
      "group": "pairwise_valid_invalid_cases",
      "steps": [...],
      "asserts": [...]
    },
    {
      "tc": "edge_cases_empty_all_fields",
      "kind": "failed",
      "group": "edge_cases",
      "steps": [...],
      "asserts": [...]
    }
  ]
}
```

### üí° ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
- ‚úÖ **Pairwise Coverage**: ‡∏•‡∏î test cases ‡∏à‡∏≤‡∏Å O(n^m) ‚Üí O(n¬≤) ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏á 2-way coverage
- ‚úÖ **PICT Integration**: ‡πÉ‡∏ä‡πâ Microsoft PICT tool (industry standard)
- ‚úÖ **DatePicker/TimePicker Support**: ‡∏™‡∏£‡πâ‡∏≤‡∏á date/time values ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô constraints
- ‚úÖ **Widget Order Preservation**: ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á steps ‡∏ï‡∏≤‡∏° manifest order

### üìä ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Test Case Reduction

| Widgets | Full Factorial | Pairwise (PICT) | Reduction |
|---------|---------------|----------------|-----------|
| 3 TextFields (2 values each) | 2¬≥ = 8 | 4 | 50% |
| 5 TextFields + 1 Dropdown (3) | 2‚Åµ √ó 3 = 96 | 12 | 87.5% |
| 10 factors (avg 3 values) | 3¬π‚Å∞ = 59,049 | ~40 | 99.9% |

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ PICT binary (`./pict`) ‡πÉ‡∏ô project root
- PICT ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Unicode (‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á Thai ‚Üí ASCII values)
- Constraints ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô PICT syntax (learning curve)

---

## üé¨ Diagram 4: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### üìÅ ‡πÑ‡∏ü‡∏•‡πå: `activity_diagram_4_test_script.puml`

### üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
‡πÅ‡∏õ‡∏•‡∏á Test Plan (JSON) ‡πÄ‡∏õ‡πá‡∏ô Flutter Integration Test Code (Dart) ‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ô

### üì• Input
- **Test Plan Files**: `output/test_data/*.testdata.json`
- **External Datasets**: `output/test_data/*.datasets.json` (optional)

### üì§ Output
- **Integration Test Files**: `integration_test/*_flow_test.dart`

### üîß ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

#### 1. **Parse Test Plan**
```dart
final j = jsonDecode(File(planPath).readAsStringSync());
final source = j['source'];
  - file, pageClass, cubitClass, stateClass
final datasets = j['datasets'];
  - byKey: {field: [{valid, invalid, invalidRuleMessages}]}
final cases = j['cases'];
  - tc, kind, group, steps, asserts
```

#### 2. **Generate Imports**
```dart
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:integration_test/integration_test.dart';
import 'package:flutter_bloc/flutter_bloc.dart';

// Import Page, Cubit, State
import 'package:master_project/demos/register_page.dart';
import 'package:master_project/cubit/register_cubit.dart';
import 'package:master_project/cubit/register_state.dart';
```

#### 3. **Generate Cubit Stubs**
‡∏™‡∏£‡πâ‡∏≤‡∏á stub classes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á API:

**Success Stub**:
```dart
class _SuccessRegisterCubit extends RegisterCubit {
  final ApiResponse? stubResp;
  _SuccessRegisterCubit({this.stubResp}) : super(shouldSucceed: true);

  @override
  Future<void> onEndButton() async {
    final resp = stubResp ?? const ApiResponse(message: "ok", code: 200);
    emit(state.copyWith(response: resp, exception: null));
  }

  @override
  Future<void> callApi() async {
    final resp = stubResp ?? const ApiResponse(message: "ok", code: 200);
    emit(state.copyWith(response: resp, exception: null));
  }
}
```

**Failure Stub**:
```dart
class _FailRegisterCubit extends RegisterCubit {
  final int code;
  _FailRegisterCubit(this.code) : super(shouldSucceed: false);

  @override
  Future<void> callApi() async {
    emit(state.copyWith(
      exception: RegisterException(message: "api_failed", code: code)
    ));
  }

  @override
  Future<void> onEndButton() async {
    emit(state.copyWith(
      exception: RegisterException(message: "api_failed", code: code)
    ));
  }
}
```

#### 4. **Generate Helper Functions**
```dart
Widget _wrap(Widget child, {
  required bool success,
  Map<String, dynamic>? response,
  int? failureCode
}) {
  final providers = <BlocProvider>[];
  providers.add(
    BlocProvider<RegisterCubit>(
      create: (_) => success
        ? _SuccessRegisterCubit(
            stubResp: response != null ? ApiResponse.fromJson(response) : null
          )
        : (failureCode != null ? _FailRegisterCubit(failureCode) : RegisterCubit())
    )
  );
  return MaterialApp(
    home: MultiBlocProvider(
      providers: providers,
      child: child
    )
  );
}
```

#### 5. **Generate Test Groups**
‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° test cases ‡∏ï‡∏≤‡∏° `group` field:
```dart
void main() {
  IntegrationTestWidgetsFlutterBinding.ensureInitialized();

  group('register_page.dart flow (integration)', () {
    group('pairwise_valid_invalid_cases', () {
      // Test cases...
    });

    group('edge_cases', () {
      // Test cases...
    });
  });
}
```

#### 6. **Generate Test Cases**

##### 6.1. Test Setup
```dart
testWidgets('pairwise_valid_invalid_cases_1', (tester) async {
  // Create providers
  final providers = <BlocProvider>[
    BlocProvider<RegisterCubit>(create: (_) => RegisterCubit()),
  ];

  // Wrap and pump
  final w = MaterialApp(
    home: MultiBlocProvider(
      providers: providers,
      child: RegisterPage()
    )
  );
  await tester.pumpWidget(w);
```

##### 6.2. Generate Steps
‡πÅ‡∏õ‡∏•‡∏á JSON steps ‡πÄ‡∏õ‡πá‡∏ô Dart code:

**enterText Step**:
```json
{"enterText": {"byKey": "1_firstname_textfield", "dataset": "byKey.1_firstname_textfield[0].valid"}}
```
‚Üì
```dart
// dataset: byKey.1_firstname_textfield[0].valid
await tester.enterText(
  find.byKey(const Key('1_firstname_textfield')),
  'Alice'
);
await tester.pump();
```

**tap Step**:
```json
{"tap": {"byKey": "customer_04_age_10_20_radio"}}
```
‚Üì
```dart
await tester.ensureVisible(find.byKey(const Key('customer_04_age_10_20_radio')));
await tester.tap(find.byKey(const Key('customer_04_age_10_20_radio')));
await tester.pump();
```

**selectDate Step**:
```json
{"selectDate": "15/01/2000"}
```
‚Üì
```dart
// Select date: 15/01/2000
{
  // Wait for DatePicker
  await tester.pumpAndSettle(const Duration(milliseconds: 500));

  // Tap year header to open year picker
  final yearInHeader = find.byWidgetPredicate(
    (widget) => widget is Text && (widget.data ?? '').contains('202'),
  );
  if (tester.any(yearInHeader)) {
    await tester.tap(yearInHeader.first);
    await tester.pumpAndSettle();
  }

  // Wait for year picker to load
  int waitAttempts = 0;
  while (waitAttempts < 50) {
    await tester.pump(const Duration(milliseconds: 50));
    final yearItems = find.byWidgetPredicate(
      (w) => w is Text && RegExp(r'^\d{4}$').hasMatch(w.data ?? ''),
    );
    if (tester.any(yearItems)) {
      await tester.pumpAndSettle();
      break;
    }
    waitAttempts++;
  }

  // Scroll to find year 2000
  int scrollAttempts = 0;
  bool scrollingUp = true;
  while (!tester.any(find.text('2000')) && scrollAttempts < 30) {
    final scrollable = find.byType(Scrollable);
    if (tester.any(scrollable)) {
      final offset = scrollingUp ? const Offset(0, -300) : const Offset(0, 300);
      await tester.drag(scrollable.first, offset);
      await tester.pumpAndSettle();
      if (scrollAttempts == 15) scrollingUp = false;
    }
    scrollAttempts++;
  }

  // Tap year
  if (tester.any(find.text('2000'))) {
    await tester.tap(find.text('2000'), warnIfMissed: false);
    await tester.pumpAndSettle();
  }
}

// Navigate to January
{
  int monthNavAttempts = 0;
  while (!tester.any(find.textContaining('Jan')) && monthNavAttempts < 12) {
    if (tester.any(find.byIcon(Icons.chevron_right))) {
      await tester.tap(find.byIcon(Icons.chevron_right));
      await tester.pumpAndSettle();
    }
    monthNavAttempts++;
  }
}

await tester.tap(find.text('15').first);
await tester.pumpAndSettle();
await tester.tap(find.text('OK'));
```

**selectTime Step**:
```json
{"selectTime": "09:00"}
```
‚Üì
```dart
// Select time: 09:00
await tester.tap(find.text('09').first);
await tester.pumpAndSettle();
await tester.tap(find.text('00').first);
await tester.pumpAndSettle();
await tester.tap(find.text('OK'));
```

##### 6.3. Generate Assertions
‡πÅ‡∏õ‡∏•‡∏á JSON asserts ‡πÄ‡∏õ‡πá‡∏ô expect():

**byKey exists**:
```json
{"byKey": "customer_success_snackbar", "exists": true}
```
‚Üì
```dart
expect(find.byKey(const Key('customer_success_snackbar')), findsOneWidget);
```

**text exists with count**:
```json
{"text": "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠", "exists": true, "count": 2}
```
‚Üì
```dart
expect(find.text('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠'), findsNWidgets(2));
```

**OR logic (integration tests)**:
```json
[
  {"byKey": "success_key", "exists": true},
  {"text": "Success message", "exists": true}
]
```
‚Üì
```dart
// Check if any expected element exists (OR logic)
final expected = [
  find.byKey(const Key('success_key')),
  find.text('Success message'),
];
expect(
  expected.any((f) => f.evaluate().isNotEmpty),
  isTrue,
  reason: 'Expected at least one of the elements to exist'
);
```

#### 7. **Dataset Resolution**
Resolve dataset paths ‡πÅ‡∏ö‡∏ö robust:
```dart
dynamic _resolveDataset(Map<String, dynamic> root, String rawPath) {
  // Support: 'byKey.field[0].valid'
  //          'byKey.field.valid[0]'
  //          'datasets.byKey.field[0].invalid'

  String path = rawPath.trim();
  dynamic cur = root;

  for (segment in path.split('.')) {
    // Parse 'field[0]' ‚Üí key='field', index=0
    final m = RegExp(r'^(.*?)(?:\[(\d+)\])?$').firstMatch(segment);
    final key = m.group(1).trim();
    final idxStr = m.group(2);

    // Navigate to key
    if (cur is Map && cur.containsKey(key)) {
      cur = cur[key];
    } else {
      return null;
    }

    // Navigate to index
    if (idxStr != null) {
      final i = int.tryParse(idxStr);
      if (cur is List && i >= 0 && i < cur.length) {
        cur = cur[i];
      } else {
        return null;
      }
    }
  }

  return cur;
}
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**:
- `"byKey.1_firstname_textfield[0].valid"` ‚Üí `"Alice"`
- `"byKey.2_email_textfield[0].invalid"` ‚Üí `"invalid.email"`
- `"byKey.3_password_textfield[0].invalidRuleMessages"` ‚Üí `"‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£"`

#### 8. **Output File Structure**
```dart
// GENERATED ‚Äî Integration tests for full flow
import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:integration_test/integration_test.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:master_project/cubit/register_cubit.dart';
import 'package:master_project/cubit/register_state.dart';
import 'package:master_project/demos/register_page.dart';

void main() {
  IntegrationTestWidgetsFlutterBinding.ensureInitialized();

  group('register_page.dart flow (integration)', () {
    group('pairwise_valid_invalid_cases', () {
      testWidgets('pairwise_valid_invalid_cases_1', (tester) async {
        // Test code...
      });
      // More test cases...
    });

    group('edge_cases', () {
      testWidgets('edge_cases_empty_all_fields', (tester) async {
        // Test code...
      });
    });
  });
}
```

### üí° ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô
- ‚úÖ **Integration Test Ready**: ‡πÉ‡∏ä‡πâ real BlocProviders ‡∏Å‡∏±‡∏ö backend ‡∏à‡∏£‡∏¥‡∏á
- ‚úÖ **Robust DatePicker/TimePicker**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö year scrolling, month navigation
- ‚úÖ **OR Logic Assertions**: ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö success/fail scenarios
- ‚úÖ **Dataset Path Resolution**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö format ‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î
- DatePicker scrolling ‡∏≠‡∏≤‡∏à‡∏ä‡πâ‡∏≤‡∏ö‡∏ô slow devices (‡πÉ‡∏ä‡πâ timeouts)
- OR logic assertions ‡∏≠‡∏≤‡∏à pass ‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πâ‡πÄ‡∏à‡∏≠‡πÅ‡∏Ñ‡πà‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô (trade-off flexibility)
- Cubit stubs ‡∏ï‡πâ‡∏≠‡∏á override methods ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (depends on implementation)

---

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô PlantUML Diagrams

### üì• ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á PlantUML

#### Option 1: VS Code Extension
1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á extension: [PlantUML by jebbs](https://marketplace.visualstudio.com/items?itemName=jebbs.plantuml)
2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Java Runtime (required):
   ```bash
   brew install openjdk@11  # macOS
   sudo apt install openjdk-11-jre  # Ubuntu
   ```
3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `.puml` ‡πÅ‡∏•‡∏∞‡∏Å‡∏î `Alt+D` (Preview)

#### Option 2: Command Line
```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á PlantUML CLI
brew install plantuml  # macOS
sudo apt install plantuml  # Ubuntu

# ‡∏™‡∏£‡πâ‡∏≤‡∏á PNG/SVG
plantuml docs/activity_diagram_1_ui_manifest.puml
plantuml -tsvg docs/activity_diagram_2_ai_datasets.puml
```

#### Option 3: Online Editor
- ‡πÄ‡∏õ‡∏¥‡∏î [PlantUML Online Editor](http://www.plantuml.com/plantuml/uml/)
- Copy-paste ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `.puml`
- Export ‡πÄ‡∏õ‡πá‡∏ô PNG/SVG/PDF

### üìÇ ‡πÑ‡∏ü‡∏•‡πå Diagrams

```
docs/
‚îú‚îÄ‚îÄ activity_diagram_1_ui_manifest.puml      # Diagram 1
‚îú‚îÄ‚îÄ activity_diagram_2_ai_datasets.puml      # Diagram 2
‚îú‚îÄ‚îÄ activity_diagram_3_pairwise_plan.puml    # Diagram 3
‚îú‚îÄ‚îÄ activity_diagram_4_test_script.puml      # Diagram 4
‚îî‚îÄ‚îÄ ACTIVITY_DIAGRAMS_README.md              # ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ
```

### üé® Customize Diagrams

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç skinparam ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ/style:
```plantuml
@startuml
skinparam activityBackgroundColor #E3F2FD  ' ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á activities
skinparam activityBorderColor #1976D2      ' ‡∏™‡∏µ‡∏Å‡∏£‡∏≠‡∏ö
skinparam decisionBackgroundColor #FFF9C4  ' ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á decisions
skinparam decisionBorderColor #F57F17      ' ‡∏™‡∏µ‡∏Å‡∏£‡∏≠‡∏ö decisions
@enduml
```

---

## üìñ ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### üéØ ‡∏™‡∏£‡∏∏‡∏õ 4 Process

| Process | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà | ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏´‡∏•‡∏±‡∏Å | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô |
|---------|---------|----------------|------------|
| 1Ô∏è‚É£ UI Manifest | ‡∏™‡∏Å‡∏±‡∏î UI widgets | Regex, AST parsing | ‚≠ê‚≠ê‚≠ê |
| 2Ô∏è‚É£ AI Datasets | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö | Gemini API, Prompt Engineering | ‚≠ê‚≠ê‚≠ê‚≠ê |
| 3Ô∏è‚É£ Pairwise Plan | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö | PICT tool, Combinatorial testing | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| 4Ô∏è‚É£ Test Script | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö | Code generation, Template engine | ‚≠ê‚≠ê‚≠ê |

### üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Project: Customer Registration Form**
- **Widgets**: 10 TextFields, 3 Radio groups, 1 Dropdown, 2 Checkboxes, 1 DatePicker
- **Full Factorial**: 2¬π‚Å∞ √ó 3¬≥ √ó 3 √ó 2¬≤ √ó 4 = 442,368 test cases
- **Pairwise (PICT)**: **68 test cases** (99.985% reduction!)
- **Generation Time**: ~15 seconds total
- **Test Execution Time**: ~3 minutes (all tests)

### üîó ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- **PICT Tool**: https://github.com/microsoft/pict
- **Gemini API**: https://ai.google.dev/gemini-api/docs
- **PlantUML**: https://plantuml.com/activity-diagram-beta
- **Flutter Testing**: https://docs.flutter.dev/testing/integration-tests

### üÜò Troubleshooting

#### ‚ùå PICT binary not found
```bash
# Download PICT for your platform
wget https://github.com/microsoft/pict/releases/download/v3.7.4/pict-darwin-arm64
chmod +x pict-darwin-arm64
mv pict-darwin-arm64 ./pict
```

#### ‚ùå Gemini API rate limit
- Free tier: 15 requests/minute
- Solution: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏•‡∏≤ delay ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á requests ‡∏´‡∏£‡∏∑‡∏≠ upgrade plan

#### ‚ùå PlantUML rendering error
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Java runtime: `java -version`
- ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ online editor ‡πÅ‡∏ó‡∏ô

### üìß ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠

- **Repository**: https://github.com/YOUR_USERNAME/master_project_v2
- **Issues**: https://github.com/YOUR_USERNAME/master_project_v2/issues
- **Email**: your.email@example.com

---

**Last Updated**: 2026-01-13
**Version**: 1.0.0
**Author**: Claude Sonnet 4.5 + Human Collaboration ü§ù
